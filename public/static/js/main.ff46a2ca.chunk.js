(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,n){},164:function(e,t,n){e.exports=n(289)},169:function(e,t,n){},170:function(e,t,n){},171:function(e,t,n){},172:function(e,t,n){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},289:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(151),i=n.n(s),o=(n(169),n(13)),c=n(16),l=n(17),u=n(9),h=n(19),p=n(18),d=(n(116),n(170),n(152));var m=function(){return r.a.createElement("div",{className:"non-navigation-content"},r.a.createElement("div",{className:"logged-out-page card"},r.a.createElement("h1",null,"Welcome to Trakr"),r.a.createElement("h3",null,"Trakr helps you"),r.a.createElement("ul",null,r.a.createElement("li",null,"stay mindful of your spending"),r.a.createElement("li",null,"prevent impulse purchases"),r.a.createElement("li",null,"find holes in your budget")),r.a.createElement("div",null,r.a.createElement("p",null,"To get started, sign in with your Google account"),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement(d.GoogleLogin,{clientId:"261179776021-aia4ltj1eq494nmfj9fl7foh28o9ckdu.apps.googleusercontent.com",buttonText:"Login",onSuccess:function(e){window.location.href="/auth/google_oauth2/callback?token=".concat(e.tokenId)},onFailure:function(e){console.log(e)},isSignedIn:!1,uxMode:"popup",cookiePolicy:"single_host_origin"})))))},g=n(54),y=(n(171),{amount:"",description:"",timestamp:"",category:"",displayForm:!1,showCategoryInput:!1}),f=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a.handleInputChange=a.handleInputChange.bind(Object(u.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(u.a)(a)),a.setDateTimePickerToNow=a.setDateTimePickerToNow.bind(Object(u.a)(a)),a.toggleExpenseForm=a.toggleExpenseForm.bind(Object(u.a)(a)),a.populateCategory=a.populateCategory.bind(Object(u.a)(a)),a.setCategory=a.setCategory.bind(Object(u.a)(a)),a.revealCategoryInput=a.revealCategoryInput.bind(Object(u.a)(a)),a.resetExpenseFormOnResponse=a.resetExpenseFormOnResponse.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.editingExpense()?this.setStateFromExistingExpense(this.props.expenseToUpdate):this.resetState()}},{key:"render",value:function(){return this.state.displayForm?this.renderNewExpenseForm():this.renderAddExpenseToggle()}},{key:"renderAddExpenseToggle",value:function(){return r.a.createElement("button",{className:"add-expense-toggle lg submit",onClick:this.toggleExpenseForm},r.a.createElement("span",{className:"lnr lnr-plus-circle"}),"Add new expense")}},{key:"renderNewExpenseForm",value:function(){return r.a.createElement("div",{className:"new-expense-form card"},r.a.createElement("h2",null,"New Expense"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Amount"),r.a.createElement("div",{className:"amount-spent-wrapper"},"$ ",r.a.createElement("input",{autoFocus:!0,placeholder:"Amount",className:"amount-spent",min:"1",value:this.state.amount,type:"number",name:"amount",onChange:this.handleInputChange}))),r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Description"),r.a.createElement("input",{value:this.state.description,type:"text",name:"description",placeholder:"What did you buy?",onChange:this.handleInputChange})),r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Category"),this.renderCategorySection(),this.renderCategoryInput()),r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Date"),r.a.createElement("input",{value:this.state.timestamp,type:"datetime-local",name:"timestamp",onChange:this.handleInputChange})),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"cancel",onClick:this.toggleExpenseForm},"Cancel"),r.a.createElement("button",{className:"submit md",disabled:this.validExpense()},this.formLabel()))))}},{key:"renderCategorySection",value:function(){return r.a.createElement("div",{className:"category-section"},this.renderCategoryList(),this.renderCategoryToggle())}},{key:"revealCategoryInput",value:function(){this.setState({showCategoryInput:!0})}},{key:"renderCategoryInput",value:function(){return this.state.showCategoryInput?r.a.createElement("input",{value:this.state.category,type:"text",name:"category",placeholder:"enter category",onChange:this.handleInputChange}):null}},{key:"renderCategoryList",value:function(){var e=this;return this.props.categories.length?this.props.categories.map((function(t){return null!=t&&t.trim().length?r.a.createElement("span",{key:t,onClick:e.setCategory,className:e.getCategoryClass(t)},t):null})):null}},{key:"renderCategoryToggle",value:function(){return this.state.showCategoryInput?null:r.a.createElement("span",{className:"category add-new-category",onClick:this.revealCategoryInput},r.a.createElement("span",{className:"lnr lnr-plus-circle"}))}},{key:"handleInputChange",value:function(e){var t=e.target.name;this.setState(Object(g.a)({},t,e.target.value))}},{key:"setCategory",value:function(e){var t=e.target.innerHTML.trim().toLowerCase(),n=t===this.state.category?"":t;this.setState({category:n})}},{key:"populateCategory",value:function(e){this.setState({category:e.target.innerHTML.trim(),showCategoryInput:!0})}},{key:"getCategoryClass",value:function(e){var t="category";return e===this.state.category&&(t+=" selected"),t}},{key:"handleSubmit",value:function(e){e.preventDefault(e);var t={amount:this.state.amount,description:this.state.description,timestamp:this.state.timestamp,category:this.state.category};this.editingExpense()?(t.id=this.state.id,this.props.submitExpenseEdit(t,this.resetExpenseFormOnResponse)):this.props.submitNewExpense(t,this.resetExpenseFormOnResponse)}},{key:"resetExpenseFormOnResponse",value:function(e){e?this.resetState():console.log("something went wrong")}},{key:"resetState",value:function(){this.setState(Object(o.a)({},y)),this.setDateTimePickerToNow()}},{key:"setStateFromExistingExpense",value:function(e){var t=new Date(e.timestamp).toISOString().slice(0,16);this.setState(Object(o.a)(Object(o.a)({},e),{},{displayForm:!0,timestamp:t}))}},{key:"setDateTimePickerToNow",value:function(){var e=6e4*(new Date).getTimezoneOffset(),t=new Date(Date.now()-e).toISOString().slice(0,16);this.setState({timestamp:t})}},{key:"validExpense",value:function(){return 0===this.state.amount||this.state.description.length<2||!this.state.timestamp.length}},{key:"toggleExpenseForm",value:function(){var e=this;this.props.toggleExpenseForm(),this.setState((function(e){return{displayForm:!e.displayForm}}),(function(){e.state.displayForm||(e.props.clearExpenseToUpdate(),e.resetState())}))}},{key:"formLabel",value:function(){return this.editingExpense()?"Save changes":"Add expense"}},{key:"editingExpense",value:function(){return Object.keys(this.props.expenseToUpdate).length}}]),n}(a.Component),v=n(46),E=(n(172),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={filteredCategory:"",displayFilter:!1},a.toggleDisplayFilter=a.toggleDisplayFilter.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"card opaque filter"},this.renderFilterContent())}},{key:"renderFilterContent",value:function(){return this.state.displayFilter?this.renderOpenFilter():this.renderClosedFilter()}},{key:"renderOpenFilter",value:function(){var e=this;return r.a.createElement("form",null,r.a.createElement("div",{className:"toggle-wrapper",onClick:this.toggleDisplayFilter},r.a.createElement("span",{className:"lnr lnr-cross"})," close filter"),r.a.createElement("div",null,r.a.createElement("label",null,"Category"),this.renderCategories()),r.a.createElement("div",null,r.a.createElement("label",null,"Description"),r.a.createElement("input",{type:"text",placeholder:"Expense name",onChange:function(t){e.props.updateDescription(t.target.value.trim())}}),r.a.createElement("br",null)),r.a.createElement("div",{className:"matching-expenses-found"},this.props.expenseCount," matching expenses found"))}},{key:"renderClosedFilter",value:function(){return r.a.createElement("div",{className:"toggle-wrapper",onClick:this.toggleDisplayFilter},r.a.createElement("span",{className:"lnr lnr-list"})," filter expenses")}},{key:"renderCategories",value:function(){var e=this;return r.a.createElement("div",{className:"category-section"},this.props.categories.map((function(t){return e.renderCategory(t)})))}},{key:"renderCategory",value:function(e){var t=this;return r.a.createElement("span",{key:e,className:this.getCategoryName(e,this.state.filteredCategory),onClick:function(){return t.updateCategory(e)}},e)}},{key:"getCategoryName",value:function(e){return e===this.state.filteredCategory?"category selected":"category"}},{key:"updateCategory",value:function(e){var t=this.state.filteredCategory===e?"":e;this.setState({filteredCategory:t}),this.props.updateCategory(t)}},{key:"toggleDisplayFilter",value:function(){this.state.displayFilter&&this.clearFilters(),document.getElementById("expense-section-heading").scrollIntoView(),this.setState((function(e){return{displayFilter:!e.displayFilter}}))}},{key:"clearFilters",value:function(){this.props.updateDescription(""),this.props.updateCategory("")}}]),n}(a.Component)),b=(n(173),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={showOptions:!1},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.expense;return r.a.createElement("div",{className:this.getClass(e.new),key:e.id},r.a.createElement("div",{className:"spending-info-wrapper"},r.a.createElement("div",{className:"amount-section"},r.a.createElement("span",{className:"amount"},"$",e.amount)),r.a.createElement("div",{className:"spending-info"},r.a.createElement("div",{className:"category"},e.category),r.a.createElement("div",null,e.description||"No description provided"))),this.renderOptions(e))}},{key:"renderOptions",value:function(e){var t=this;return this.state.showOptions?r.a.createElement("div",{className:"options-button-wrapper"},r.a.createElement("button",{onClick:function(n){t.props.editExpense(n,e.id)},className:"cancel lnr lnr-pencil"}),r.a.createElement("button",{onClick:function(n){t.props.deleteExpense(n,e.id)},className:"cancel lnr lnr-trash"}),r.a.createElement("button",{onClick:function(e){return t.toggleMenu(e)},className:"cancel lnr lnr-cross-circle"})):r.a.createElement("button",{onClick:function(e){return t.toggleMenu(e)},className:"cancel lnr lnr-menu-circle"})}},{key:"getClass",value:function(e){var t=void 0!==e&&e?"one-expense new":"one-expense";return this.state.showOptions&&(t+=" stack-vertically"),t}},{key:"toggleMenu",value:function(e){e.preventDefault(),this.setState((function(e){return{showOptions:!e.showOptions}}))}}]),n}(a.Component));n(174);function x(e){return r.a.createElement("div",null,function(e,n,a){if(!e.length)return r.a.createElement("p",null,"No expenses - you should add one!");return function(e){var n=(e=e.sort((function(e,t){return new Date(t.timestamp)-new Date(e.timestamp)}))).map((function(e){return t(e.timestamp)}));return Object(v.a)(new Set(n))}(e).map((function(s){var i=function(e,n){return e.filter((function(e){return t(e.timestamp)===n}))}(e,s),o=function(e,t,n,a){return e.map((function(e){return r.a.createElement(b,{key:e.id,expense:e,deleteExpense:n,editExpense:a})}))}(i,0,n,a),c=function(e){return e.reduce((function(e,t){return e+t.amount}),0)}(i);return r.a.createElement("div",{className:"day-of-expenses",key:s},r.a.createElement("div",{className:"date-header"},r.a.createElement("span",null,s),r.a.createElement("span",{className:"daily-spending-total"},"$",c)),o)}))}(e.expenses,e.deleteExpense,e.editExpense));function t(e){var t=e.substring(0,10).split("-");return"".concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Number(t[1])-1]," ").concat(t[2],", ").concat(t[0])}}n(175);var k=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={filteredCategory:"",filteredDescription:"",filteredMinAmount:0,filteredMaxAmount:1/0},a.updateCategory=a.updateCategory.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.filteredExpenses();return r.a.createElement("div",null,r.a.createElement("h3",{className:"expense-heading",id:"expense-section-heading"},"Expenses"),r.a.createElement(E,{updateCategory:function(t){return e.updateCategory(t)},updateDescription:function(t){return e.updateDescription(t)},categories:this.getExpenseCategories(),expenseCount:t.length}),r.a.createElement(x,{expenses:t,deleteExpense:this.props.deleteExpense,editExpense:this.props.editExpense}))}},{key:"filteredExpenses",value:function(){var e=this;return this.state.filteredCategory.length||this.state.filteredDescription.length?this.props.expenses.filter((function(t){return t.category.includes(e.state.filteredCategory)&&t.description.includes(e.state.filteredDescription)})):this.props.expenses}},{key:"getExpenseCategories",value:function(){return Object(v.a)(new Set(this.props.expenses.map((function(e){return e.category}))))}},{key:"updateCategory",value:function(e){this.setState({filteredCategory:e})}},{key:"updateDescription",value:function(e){this.setState({filteredDescription:e})}}]),n}(a.Component),C=(n(176),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).moneySpentToday=a.moneySpentToday.bind(Object(u.a)(a)),a.moneySpentThisMonth=a.moneySpentThisMonth.bind(Object(u.a)(a)),a.dailyBudget=a.dailyBudget.bind(Object(u.a)(a)),a.monthlyBalance=a.monthlyBalance.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"dashboard"},this.displayingCurrentMonth()?this.renderThisMonthsDashboard():this.renderAnotherMonthsDashboard())}},{key:"renderThisMonthsDashboard",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"card thin square full-square"},r.a.createElement("div",{className:"label"},"Spent today"),r.a.createElement("div",{className:"metric"},r.a.createElement("span",{className:this.getMetricClass(this.dailyBudget()-this.moneySpentToday())},this.moneyFormat(this.moneySpentToday())),r.a.createElement("span",{className:"submetric"},"|",this.moneyFormat(this.dailyBudget())))),r.a.createElement("div",{className:"half-square-wrapper"},r.a.createElement("div",{className:"card thin square half-square"},r.a.createElement("div",{className:"label"},"Spent this month"),r.a.createElement("div",{className:"metric"},r.a.createElement("span",{className:this.getMetricClass(this.props.monthlyBudget-this.moneySpentThisMonth())},this.moneyFormat(this.moneySpentThisMonth())),r.a.createElement("span",{className:"submetric"},"|",this.moneyFormat(this.props.monthlyBudget)))),r.a.createElement("div",{className:"card thin square half-square"},r.a.createElement("div",{className:"label"},"Monthly balance"),r.a.createElement("div",{className:"metric"},r.a.createElement("span",{className:this.getMetricClass(this.monthlyBalance())},this.moneyFormat(this.monthlyBalance()))))))}},{key:"renderAnotherMonthsDashboard",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"card thin square full-square"},r.a.createElement("div",{className:"label"},"Spent this month"),r.a.createElement("div",{className:"metric"},r.a.createElement("span",null,this.moneyFormat(this.moneySpentThisMonth())),r.a.createElement("span",{className:"submetric"},"|",this.moneyFormat(this.props.monthlyBudget)))))}},{key:"moneySpentToday",value:function(){var e=this;return this.props.expenses.reduce((function(t,n){return e.isToday(n.timestamp)?t+n.amount:t}),0)}},{key:"moneySpentThisMonth",value:function(){var e=this;return this.props.expenses.reduce((function(t,n){return e.expenseIsInThisMonth(new Date,n.timestamp)?t+n.amount:t}),0)}},{key:"isToday",value:function(e){var t=new Date;return(e=new Date(e)).setHours(e.getHours()+e.getTimezoneOffset()/60),t.getYear()===e.getYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}},{key:"expenseIsInThisMonth",value:function(e,t){return t=new Date(t),this.props.currentDate.year===t.getYear()+1900&&this.props.currentDate.month===t.getMonth()+1}},{key:"displayingCurrentMonth",value:function(){var e=new Date;return this.props.currentDate.year===e.getYear()+1900&&this.props.currentDate.month===e.getMonth()+1}},{key:"leftToSpendToday",value:function(){return this.dailyBudget()-this.moneySpentToday()}},{key:"monthlyBalance",value:function(){var e=new Date;return this.dailyBudget()*e.getDate()-this.moneySpentThisMonth()}},{key:"monthProgress",value:function(){var e=new Date;return Math.floor(e.getDate()/this.daysInMonth(e.getMonth(),e.getYear())*100)}},{key:"dailyBudget",value:function(){var e=new Date;return Math.floor(this.props.monthlyBudget/this.daysInMonth(e.getMonth(),e.getYear()))}},{key:"daysInMonth",value:function(e,t){return new Date(t,e+1,0).getDate()}},{key:"moneyFormat",value:function(e){return e>=0?"$".concat(e):"-$".concat(Math.abs(e))}},{key:"getMetricClass",value:function(e){return e<0?"negative":""}}]),n}(a.Component));n(177);var N=function(e){return r.a.createElement("div",{className:"navigation-section"},function(e){return r.a.createElement("div",{className:"navigation-full-width-wrapper"},r.a.createElement("div",{className:"nav-bar borderless card navigation-icon-bar"},r.a.createElement("div",{className:"nav-button button",onClick:function(){return e.navigateToPage("home")}},r.a.createElement("img",{className:"user-photo",src:e.userImage,alt:"profile pic"})),r.a.createElement("div",{className:"nav-button button",onClick:function(){return e.navigateToPage("analytics")}},r.a.createElement("span",{className:"lnr lnr-pie-chart"})),r.a.createElement("div",{className:"nav-button button",onClick:function(){return e.navigateToPage("settings")}},r.a.createElement("span",{className:"lnr lnr-menu"}))))}(e),function(e){if(!e.renderDateSelector)return null;return r.a.createElement("div",{className:"nav-bar borderless card date-selector"},r.a.createElement("div",{className:"nav-button button",onClick:function(){return e.previousMonth()}},r.a.createElement("span",{className:"lnr lnr-chevron-left"})),r.a.createElement("div",{className:"date button",onClick:function(){return e.setCurrentDate()}},(t=e.date,"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][t.month-1]," ").concat(t.year))),r.a.createElement("div",{className:"nav-button button",onClick:function(){return e.nextMonth()}},r.a.createElement("span",{className:"lnr lnr-chevron-right"})));var t}(e))},M=(n(178),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={defaultMonthlyBudget:a.props.defaultMonthlyBudget,currentMonthlyBudget:a.props.currentMonthlyBudget,preferredFirstName:a.props.preferredFirstName},a.handleInputChange=a.handleInputChange.bind(Object(u.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"settings card"},r.a.createElement("h3",null,"Settings"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Default budget"),r.a.createElement("input",{value:this.state.defaultMonthlyBudget,type:"number",name:"defaultMonthlyBudget",onChange:this.handleInputChange})),r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"This month's budget"),r.a.createElement("input",{value:this.state.currentMonthlyBudget,type:"number",name:"currentMonthlyBudget",onChange:this.handleInputChange})),r.a.createElement("div",{className:"one-input"},r.a.createElement("label",null,"Preferred first name"),r.a.createElement("input",{value:this.state.preferredFirstName,type:"text",name:"preferredFirstName",onChange:this.handleInputChange})),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"submit md",disabled:this.validSettings()},"Update Settings")))),r.a.createElement("div",{className:"settings card borderless logout"},r.a.createElement("a",{href:"/logout"},r.a.createElement("span",null,"Log out"),r.a.createElement("span",{className:"lnr lnr-arrow-right"}))))}},{key:"handleInputChange",value:function(e){var t=e.target.name;this.setState(Object(g.a)({},t,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(e);var t={defaultMonthlyBudget:Number(this.state.defaultMonthlyBudget),currentMonthlyBudget:Number(this.state.currentMonthlyBudget),preferredFirstName:this.state.preferredFirstName.trim()};this.props.updateUserSettings(t)}},{key:"validSettings",value:function(){return 0===this.state.monthlyBudget||0===this.state.currentMonthlyBudget}}]),n}(a.Component));n(179),n(180);function S(e){return r.a.createElement("div",{className:"card opaque occurence-calendar"},r.a.createElement("h3",null,"Days I bought"+("all"===(t=e.category)?" anything":" ".concat(t))),r.a.createElement("div",{className:"cell-wrapper"},function(e){for(var t=7-e.daysThisMonth%7,n=[],a=function(t){var a=e.expenses.filter((function(e){return t===function(e){var t=new Date(e);return t.setHours(t.getHours()+t.getTimezoneOffset()/60),t.getDate()}(e.timestamp)})).length?"cell has-spending  ":"cell";n.push(r.a.createElement("div",{className:a,key:t},t))},s=1;s<=e.daysThisMonth;s++)a(s);for(var i=1;i<=t;i++)n.push(r.a.createElement("div",{className:"cell invisible",key:"invisible-".concat(i)}));return n}(e)));var t}n(181);function O(e){return e.expenses.length?r.a.createElement("div",{className:"card opaque"},r.a.createElement("h3",null,"Quick stats on "+("all"===(n=e.category)?" all spending":" ".concat(n))),r.a.createElement("div",{className:"one-statistic"},r.a.createElement("span",{className:"name"},"Total purchases"),r.a.createElement("span",{className:"value"},e.expenses.length)),r.a.createElement("div",{className:"one-statistic"},r.a.createElement("span",{className:"name"},"Average $ per purchase"),r.a.createElement("span",{className:"value"},"$",function(e){if(!e.length)return w(0);return w(D(e)/e.length)}(e.expenses))),r.a.createElement("div",{className:"one-statistic"},r.a.createElement("span",{className:"name"},"Average $ per day"),r.a.createElement("span",{className:"value"},"$",(t=e.expenses,e.daysThisMonth,w(D(t)/j(t))))),r.a.createElement("div",{className:"one-statistic"},r.a.createElement("span",{className:"name"},"Purchases per day"),r.a.createElement("span",{className:"value"},function(e,t){return Math.floor(e.length/j(e)*10)/10}(e.expenses,e.daysThisMonth))),r.a.createElement("div",{className:"one-statistic"},r.a.createElement("span",{className:"name"},"Average purchase is every"),r.a.createElement("span",{className:"value"},function(e,t){return Math.floor(function(e,t){var n=new Date;return function(e){var t=new Date,n=new Date(e.timestamp);return t.getMonth()===n.getMonth()&&t.getYear()===n.getYear()}(e)?n.getDate():t}(e[0],t)/j(e)*10)/10}(e.expenses,e.daysThisMonth)," days"))):null;var t,n}function D(e){return e.reduce((function(e,t){return e+t.amount}),0)}function w(e){return(Math.round(100*e)/100).toFixed(2)}function j(e){var t=e.map((function(e){return new Date(e.timestamp).getDate()}));return Object(v.a)(new Set(t)).length}n(182);var T=n(298),F=n(302),B=n(305),I=n(306),P=n(299),Y=n(301),A=n(300),U=n(303),L=n(304);function q(e){return function(e){var t=function(e,t){for(var n=[],a=function(t){var a=0;e.forEach((function(e){new Date(e.timestamp).getDate()===t&&(a+=e.amount)})),n.push({amount:a,date:t})},r=1;r<=t;r++)a(r);return n}(e.currentMonthExpenses,e.daysThisMonth),n=function(e,t){for(var n=[],a=function(a){var r=0;e.forEach((function(e){var n=new Date(e.timestamp),s=n.getMonth(),i=n.getYear()+1900;s===a&&i===t&&(r+=e.amount)})),n.push({amount:r,month:a})},r=0;r<=11;r++)a(r);return n}(e.currentYearExpenses,e.displayYear),a=z(e.category,"month"),s=z(e.category,"year"),i=e.currentMonthExpenses.length?function(e){var t=e.expenses,n=e.daysThisMonth,a=e.monthlyBudget,s=e.category;return r.a.createElement("div",{className:"chart card opaque"},r.a.createElement("h3",{className:"chart-title"},R(s)),r.a.createElement(T.a,{title:R(s),domainPadding:30,theme:F.a.material,maxDomain:{x:31,y:$(t,a,n)},containerComponent:r.a.createElement(B.a,{style:{pointerEvents:"auto",userSelect:"auto",touchAction:"auto"}})},r.a.createElement(A.a,{x:45,gutter:30,orientation:"horizontal",data:[{name:"Average spending",symbol:{fill:"#e47575"}},{name:"Daily budget",symbol:{fill:"#1d82ff"}}],style:{labels:{fontSize:12}}}),r.a.createElement(I.a,{tickCount:Math.floor(n/2),style:{tickLabels:{fontSize:10}}}),r.a.createElement(I.a,{dependentAxis:!0,range:{x:[1,n]},tickFormat:function(e){return"$".concat(e)}}),r.a.createElement(U.a,{style:{data:{fill:"rgb(29, 130, 255, 0.09)"},strokeWidth:0},data:[{x:0,y:n},{x:0,y:J(n,a)},{x:n,y:J(n,a)},{x:n,y:0}]}),r.a.createElement(P.a,{barRatio:.7,data:t,labels:function(e){e.datum;return""},labelComponent:r.a.createElement(Y.a,{backgroundStyle:{fill:"white",opacity:.6},backgroundPadding:{left:3,right:4},style:[{fill:"rgb(69, 90, 100)",fontSize:9,fontFamily:"sans-serif"}]}),x:"date",y:"amount"}),r.a.createElement(L.a,{data:[{x:0,y:H(t)},{x:n,y:H(t)}],style:{data:{stroke:"#e47575",strokeWidth:1,strokeDasharray:[5,5]}},labelComponent:r.a.createElement(Y.a,{backgroundStyle:{fill:"#e47575",opacity:.1},backgroundPadding:{left:3,right:4,bottom:1},style:[{fill:"#e47575",fontSize:11,fontFamily:"sans-serif"}],dx:-10}),labels:function(e){var t=e.datum;if(t.x)return"$".concat(t.y)}}),r.a.createElement(L.a,{data:[{x:0,y:J(n,a)},{x:n,y:J(n,a)}],style:{data:{stroke:"#1d82ff",strokeWidth:1,strokeDasharray:[5,5]}},labelComponent:r.a.createElement(Y.a,{backgroundStyle:{fill:"#1d82ff",opacity:.1},backgroundPadding:{left:3,right:4,bottom:1},style:[{fill:"#1d82ff",fontSize:11,fontFamily:"sans-serif"}],dx:-10}),labels:function(e){var t=e.datum;if(t.x)return"$".concat(t.y)}})))}(Object(o.a)(Object(o.a)({},e),{},{expenses:t})):a,c=e.currentYearExpenses.length?function(e){var t=e.expenses,n=(e.daysThisMonth,e.monthlyBudget,e.category),a=e.displayYear,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return r.a.createElement("div",{className:"chart card opaque"},r.a.createElement("h3",{className:"chart-title"},W(n,a)),r.a.createElement(T.a,{title:W(n),theme:F.a.material,maxDomain:{x:12},domainPadding:30,containerComponent:r.a.createElement(B.a,{style:{pointerEvents:"auto",userSelect:"auto",touchAction:"auto"}})},r.a.createElement(I.a,{tickCount:13,style:{tickLabels:{fontSize:10}},tickFormat:function(e){return s[e]}}),r.a.createElement(I.a,{dependentAxis:!0,tickFormat:function(e){return"$".concat(e)}}),r.a.createElement(P.a,{alignment:"start",data:t,labels:function(e){var t=e.datum;return t.amount>0?"$".concat(t.amount):""},labelComponent:r.a.createElement(Y.a,{backgroundStyle:{fill:"white",opacity:.6},backgroundPadding:{left:3,right:4},style:[{fill:"rgb(69, 90, 100)",fontSize:9,fontFamily:"sans-serif"}]}),x:"date",y:"amount"})))}(Object(o.a)(Object(o.a)({},e),{},{expenses:n})):s;return r.a.createElement("div",{className:"charts"},i,c)}(e)}function $(e,t,n){var a=e.map((function(e){return e.amount})),r=Math.max.apply(Math,Object(v.a)(a));return Math.max(1.1*J(n,t),1.1*r)}function J(e,t){return Math.round(t/e)}function H(e){var t=e.map((function(e){return e.amount?e.amount:""})),n=(t=t.filter((function(e){return""!==e}))).reduce((function(e,t){return e+t}))/t.length;return Math.round(n)}function z(e,t){var n="all"===e?"":e;return r.a.createElement("div",{className:"chart card opaque"},"There are no recorded ",n," expenses this ",t)}function R(e){return"Daily spending"+("all"===e?"":" on ".concat(e))}function W(e,t){return"Month-over-month spending"+("all"===e?"":" on ".concat(e))+" in ".concat(t)}var _=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={currentCategory:"all"},a.handleClick=a.handleClick.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"analytics"},this.renderCategorySelector(),this.renderSpendingStatistics(),this.renderOccurenceCalendar(),this.renderCharts())}},{key:"renderCategorySelector",value:function(){if(!this.props.currentMonthExpenses.length)return null;var e=this.sortExpensesByCategory();return r.a.createElement("div",{className:"card thin"},this.renderSpendingHeaders(this.props.currentMonthExpenses.length),this.renderTableOfSpendingByCategory(e))}},{key:"renderOccurenceCalendar",value:function(){return this.props.currentMonthExpenses.length?r.a.createElement(S,{daysThisMonth:this.props.daysThisMonth,category:this.state.currentCategory,expenses:this.filteredExpenses(this.props.currentMonthExpenses)}):null}},{key:"renderSpendingStatistics",value:function(){return r.a.createElement(O,{expenses:this.filteredExpenses(this.props.currentMonthExpenses),category:this.state.currentCategory,daysThisMonth:this.props.daysThisMonth})}},{key:"renderCharts",value:function(){return r.a.createElement(q,{currentMonthExpenses:this.filteredExpenses(this.props.currentMonthExpenses),currentYearExpenses:this.filteredExpenses(this.aggregateYearlyExpenses()),category:this.state.currentCategory,daysThisMonth:this.props.daysThisMonth,monthlyBudget:this.props.monthlyBudget,displayYear:this.props.displayYear})}},{key:"renderSpendingHeaders",value:function(){return r.a.createElement("div",{className:"category-header-row"},r.a.createElement("span",{className:"category-name"},"Category"),r.a.createElement("span",{className:"category-amount"},"Sum"),r.a.createElement("span",{className:"category-percentage"},"%"))}},{key:"renderTableOfSpendingByCategory",value:function(e){var t=this;if(Object.keys(e).length)return[{category:"all",amount:this.sumOfAllExpenses()}].concat(Object.keys(e).map((function(t){return{category:t,amount:Number(e[t])}})).sort((function(e,t){return e.amount<t.amount?1:-1}))).map((function(e){return r.a.createElement("div",{className:t.getCategoryRowClass(e.category),key:e.category,onClick:function(){return t.handleClick(e.category)}},r.a.createElement("span",{className:"category-name"},e.category),r.a.createElement("span",{className:"category-amount"},"$",e.amount),r.a.createElement("span",{className:"category-percentage"},t.percentageOfMonthlySpending(e.amount),"%"))}))}},{key:"sortExpensesByCategory",value:function(){var e={};return this.props.currentMonthExpenses.forEach((function(t){var n=t.category;"undefined"===typeof e[n]?e[n]=t.amount:e[n]+=t.amount})),e}},{key:"handleClick",value:function(e){this.setState({currentCategory:e})}},{key:"aggregateYearlyExpenses",value:function(){var e=[];for(var t in this.props.currentYearExpenses)e=e.concat(this.props.currentYearExpenses[t]);return e}},{key:"filteredExpenses",value:function(e){var t=this;return"all"===this.state.currentCategory?e:e.filter((function(e){return e.category===t.state.currentCategory}))}},{key:"percentageOfMonthlySpending",value:function(e){return Math.floor(e/this.sumOfAllExpenses()*1e3)/10}},{key:"sumOfAllExpenses",value:function(){return this.props.currentMonthExpenses.reduce((function(e,t){return e+t.amount}),0)}},{key:"getCategoryRowClass",value:function(e){return"one-category-row"+(this.state.currentCategory===e?" selected":"")}}]),n}(a.Component),G=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={status:"loading",user:null,expenses:{},expenseToUpdate:{},categories:[],defaultMonthlyBudget:0,pastBudgets:{},greeting:"Hi",currentDate:{month:1,year:1990},showExpenseForm:!1,currentPage:"home",datepickerPages:["home","analytics"]},a.fetchExpenses=a.fetchExpenses.bind(Object(u.a)(a)),a.fetchUserSettings=a.fetchUserSettings.bind(Object(u.a)(a)),a.submitNewExpense=a.submitNewExpense.bind(Object(u.a)(a)),a.submitExpenseEdit=a.submitExpenseEdit.bind(Object(u.a)(a)),a.deleteExpense=a.deleteExpense.bind(Object(u.a)(a)),a.navigateToPage=a.navigateToPage.bind(Object(u.a)(a)),a.updateUserSettings=a.updateUserSettings.bind(Object(u.a)(a)),a.toggleExpenseForm=a.toggleExpenseForm.bind(Object(u.a)(a)),a.previousMonth=a.previousMonth.bind(Object(u.a)(a)),a.nextMonth=a.nextMonth.bind(Object(u.a)(a)),a.setCurrentDate=a.setCurrentDate.bind(Object(u.a)(a)),a.editExpense=a.editExpense.bind(Object(u.a)(a)),a.clearExpenseToUpdate=a.clearExpenseToUpdate.bind(Object(u.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setCurrentDate(),this.fetchSession()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},this.renderContent())}},{key:"renderContent",value:function(){switch(this.state.status){case"loggedIn":return this.renderLoggedInInterface();case"loggedOut":return r.a.createElement(m,null);default:return null}}},{key:"renderLoggedInInterface",value:function(){return r.a.createElement("div",null,this.renderNavigation(),r.a.createElement("div",{className:"non-navigation-content"},this.renderLoggedInBodyContent()))}},{key:"renderLoggedInBodyContent",value:function(){return"home"===this.state.currentPage?this.renderHome():"analytics"===this.state.currentPage?this.renderAnalytics():"settings"===this.state.currentPage?this.renderSettings():void 0}},{key:"renderHome",value:function(){return r.a.createElement("div",{className:"home"},this.renderDashboard(),r.a.createElement(f,{key:this.state.expenseToUpdate.updated_at||0,submitNewExpense:this.submitNewExpense,submitExpenseEdit:this.submitExpenseEdit,toggleExpenseForm:this.toggleExpenseForm,categories:this.state.categories,expenseToUpdate:this.state.expenseToUpdate,clearExpenseToUpdate:this.clearExpenseToUpdate}),this.renderExpenseList())}},{key:"renderNavigation",value:function(){return this.state.showExpenseForm?null:r.a.createElement(N,{navigateToPage:this.navigateToPage,renderDateSelector:this.pageShouldIncludeDatepicker(),date:this.state.currentDate,nextMonth:this.nextMonth,previousMonth:this.previousMonth,setCurrentDate:this.setCurrentDate,userImage:this.state.user.image})}},{key:"renderDashboard",value:function(){return this.state.showExpenseForm?null:r.a.createElement(C,{expenses:this.currentMonthExpenses(),monthlyBudget:this.getCurrentMonthlyBudget(),currentDate:this.state.currentDate})}},{key:"renderExpenseList",value:function(){return r.a.createElement(k,{expenses:this.currentMonthExpenses(),deleteExpense:this.deleteExpense,editExpense:this.editExpense})}},{key:"renderAnalytics",value:function(){return r.a.createElement(_,{currentMonthExpenses:this.currentMonthExpenses(),currentYearExpenses:this.currentYearExpenses(),categories:this.state.categories,monthlyBudget:this.getCurrentMonthlyBudget(),daysThisMonth:this.daysThisMonth(),displayYear:this.state.currentDate.year})}},{key:"renderSettings",value:function(){return r.a.createElement(M,{defaultMonthlyBudget:this.state.defaultMonthlyBudget,currentMonthlyBudget:this.getCurrentMonthlyBudget(),preferredFirstName:this.state.user.firstName,updateUserSettings:this.updateUserSettings,pastBudgets:this.state.pastBudgets,key:this.state.defaultMonthlyBudget+this.getCurrentMonthlyBudget()})}},{key:"getCurrentMonthlyBudget",value:function(){if(void 0!==this.state.pastBudgets){var e=this.formattedMonth(this.state.currentDate.month),t=this.formattedYear(this.state.currentDate.year),n="".concat(t,"-").concat(e);return void 0===this.state.pastBudgets[n]?this.state.defaultMonthlyBudget:this.state.pastBudgets[n]}}},{key:"submitNewExpense",value:function(e,t){var n=this;fetch("/api/v1/expenses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(a){if(200===a.status){var r=n.state.categories,s=n.insertOneExpense(a.newExpense);r.includes(e.category)||(r=r.concat(e.category)),n.setState({expenses:s,categories:r},(function(){n.toggleExpenseForm(),t(!0)}))}else console.log(a.message)})).catch((function(e){console.log("Error submitting expense",e)}))}},{key:"submitExpenseEdit",value:function(e,t){var n=this;fetch("/api/v1/expenses",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(a){if(200===a.status){var r=n.state.categories,s=n.updateOneExpense(a.updatedExpense);r.includes(e.category)||(r=r.concat(e.category)),n.setState({expenses:s,categories:r},(function(){n.toggleExpenseForm(),t(!0)}))}else console.log(a.message)})).catch((function(e){console.log("Error updating expense",e)}))}},{key:"deleteExpense",value:function(e,t){var n=this;e.stopPropagation(),fetch("/api/v1/expenses/".concat(t).concat(this.yearParams()),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){n.setState({expenses:n.generateUpdatedExpenseList(e.expenses),categories:e.categories})})).catch((function(e){console.log("Error fetching data",e)}))}},{key:"clearExpenseToUpdate",value:function(){this.setState({expenseToUpdate:{}})}},{key:"editExpense",value:function(e,t){e.stopPropagation();var n=this.findExpenseById(t);this.setState({expenseToUpdate:n,showExpenseForm:!0})}},{key:"findExpenseById",value:function(e){return this.currentMonthExpenses().filter((function(t){return t.id===e}))[0]}},{key:"fetchSession",value:function(){var e=this;fetch("/session",this.fetchOptions()).then((function(e){return e.json()})).then((function(t){e.setState({status:t.status,user:t.loggedInUser},(function(){"loggedIn"===e.state.status&&(e.fetchExpenses(),e.fetchUserSettings())}))})).catch((function(e){console.log("Error fetching session data",e)}))}},{key:"fetchExpenses",value:function(){var e=this;fetch("/api/v1/expenses/".concat(this.yearParams())).then((function(e){return e.json()})).then((function(t){e.setState({expenses:e.generateUpdatedExpenseList(t.expenses),categories:t.categories})})).catch((function(e){console.log("Error fetching data",e)}))}},{key:"fetchUserSettings",value:function(){var e=this;fetch("/api/v1/users/settings").then((function(e){return e.json()})).then((function(t){var n=Object(o.a)({},e.state.user);n.firstName=t.preferredFirstName,e.setState({defaultMonthlyBudget:t.defaultMonthlyBudget,pastBudgets:t.pastBudgets,user:n})})).catch((function(e){console.log("Error fetching data",e)}))}},{key:"setCurrentDate",value:function(){var e=new Date,t={month:e.getMonth()+1,year:1900+e.getYear()};this.setState({currentDate:t})}},{key:"updateUserSettings",value:function(e){var t=this;fetch("/api/v1/users/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){var n=Object(o.a)({},t.state.user);n.firstName=e.preferredFirstName,t.setState({defaultMonthlyBudget:e.defaultMonthlyBudget,pastBudgets:e.pastBudgets,currentPage:"home",user:n})})).catch((function(e){console.log("Error fetching data",e)}))}},{key:"navigateToPage",value:function(e){this.setState({currentPage:e})}},{key:"pageShouldIncludeDatepicker",value:function(){return this.state.datepickerPages.includes(this.state.currentPage)}},{key:"fetchOptions",value:function(){return{headers:{"Content-Type":"application/json","X-CSRF-Token":"someTestValue"}}}},{key:"toggleExpenseForm",value:function(){this.setState((function(e){return{showExpenseForm:!e.showExpenseForm}}))}},{key:"yearParams",value:function(){return"?year=".concat(this.state.currentDate.year)}},{key:"nextMonth",value:function(){var e=this.state.currentDate.month<12?this.state.currentDate.month+1:1,t=1===e?this.state.currentDate.year+1:this.state.currentDate.year;this.updateCurrentDate(e,t)}},{key:"previousMonth",value:function(){var e=this.state.currentDate.month>1?this.state.currentDate.month-1:12,t=12===e?this.state.currentDate.year-1:this.state.currentDate.year;this.updateCurrentDate(e,t)}},{key:"updateCurrentDate",value:function(e,t){var n=this,a={month:e,year:t};this.setState({currentDate:a},(function(){n.thisYearsExpensesAreAvailable()||n.fetchExpenses()}))}},{key:"thisYearsExpensesAreAvailable",value:function(){var e=this.state.currentDate.year;return"undefined"!==typeof this.state.expenses[e]}},{key:"generateUpdatedExpenseList",value:function(e){var t=this,n=this.formattedYear(this.state.currentDate.year),a=Object(o.a)({},this.state.expenses);return a[n]={},e.forEach((function(e){var r=new Date(e.timestamp).getMonth()+1,s=t.formattedMonth(r);"undefined"===typeof a[n][s]?a[n][s]=[e]:a[n][s].push(e)})),a}},{key:"insertOneExpense",value:function(e){var t=Object(o.a)({},this.state.expenses),n=this.formattedMonth(new Date(e.timestamp).getMonth()+1),a=this.formattedYear(new Date(e.timestamp).getYear()+1900);return void 0===t[a][n]&&(t[a][n]=[]),t[a][n].push(Object(o.a)(Object(o.a)({},e),{},{new:!0})),t}},{key:"updateOneExpense",value:function(e){var t=Object(o.a)({},this.state.expenses),n=this.formattedMonth(new Date(e.timestamp).getMonth()+1),a=this.formattedYear(new Date(e.timestamp).getYear()+1900);return t[a][n]=t[a][n].map((function(t){return t.id===e.id?Object(o.a)(Object(o.a)({},e),{},{new:!0}):t})),t}},{key:"currentMonthExpenses",value:function(){return"undefined"===typeof this.state.expenses[this.formattedYear(this.state.currentDate.year)]?[]:this.state.expenses[this.formattedYear(this.state.currentDate.year)][this.formattedMonth(this.state.currentDate.month)]||[]}},{key:"currentYearExpenses",value:function(){return"undefined"===typeof this.state.expenses[this.formattedYear(this.state.currentDate.year)]?[]:this.state.expenses[this.formattedYear(this.state.currentDate.year)]||[]}},{key:"formattedMonth",value:function(e){return 1===e.toString().length?"0".concat(e):e.toString()}},{key:"formattedYear",value:function(e){return e.toString()}},{key:"daysThisMonth",value:function(){return new Date(this.state.currentDate.year,this.state.currentDate.month,0).getDate()}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[164,1,2]]]);
//# sourceMappingURL=main.ff46a2ca.chunk.js.map